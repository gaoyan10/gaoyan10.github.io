---
layout: post
title: 为什么你的项目做着做着就烂了
categories: [读书笔记]
tags: [ruby, 重构]
---

### 前言
本篇内容为最近一段时间工作心得整理。一直想整理，看整本书正好是个引子。对书的评价最后在说。

### 开发常态
每个公司的开发状况都有点区别，不同的业务，不同的CTO在开发具体表现上都有点区别。但是在实践中，会发现大家面临的场景是何其相似。。

大部分场景是这样的（按时间线来拍）：

#### 角色
未知：CEO  	
汪汪：产品狗  	
套套：CTO+首席科学家		
菜菜：全栈设计师		
面面：niubility页面仔		

#### 场景1（开始）	
汪汪：我们的产品 **一品茶** 需求已经讨论的差不多了。接下来一段时间我会出UE稿。你们开发要多久？		
套套：按照这个需求，我估计1个半月可以做完		
面面：我也差不多		
CEO：好，那咱们1个半月上线，你们1个月能做完吧？		
套套：赶赶进度应该可以。		
CEO：那，那你们加油，月底做完，下个月中旬咱们发布产品。		
套套：。。。		
绵绵：。。。			
套套：面面，咱们赶紧开始搭建基础框架吧。		
面面：冇闷忒。		

#### 场景2（改需求）	
套套：妈蛋，刚设计好模型和数据库，需求就改了。还好我前期考虑到了这点。		
面面：......		

#### 场景3（发现bug）		
汪汪：面面，我发现你这个功能有个bug，你看看。		
面面：怎么可能？我看一下。		
...（半小时）		
面面：套套，这个功能是你给的接口有问题。你看下。		
套套：给我5分钟，我开发完手里功能给你调。		

#### 场景4（持续bug）	
汪汪：面面，这个功能上周我测试过明明是好的，怎么又出问题了？	
面面：怎么可能？我看一下。		
...（1小时）		
面面：（望着套套），哥，你这个接口是不是改了？		
套套：给我5分钟 		
...（1小时）		
套套：（找到面面），不好意思，我2个接口复用了1个公共方法，今天改bug，忘记把之前的接口参数一起改了。		

#### 场景5（崩溃）		
汪汪：套套，面面，还有3天就月底了。。怎么这么多功能还没做完？		
套套：没办法啊，你老改需求，我这边功能还没开发完，你就改了。		
面面：我前端部分没什么问题，后台接口没出来，我没法做		
汪汪：那以前做好的功能，为什么又不能用啊？		
套套：bug是正常的嘛。慢慢改。		
汪汪：。。。		
CEO：要多久？		
套套：还要2周		
CEO：。。。		
...（1个月）		

#### 场景6（上线）		
汪汪：兄弟们，不容易啊，咱们产品反馈不错，现在要增加个功能。		
套套：。。。		
面面：。。。		
		
#### 场景7		
套套：面面，现在这代码我是维护不下去了。我准备换工作了。		

<br>

不知道大家对以上以场景是否熟悉？
提取以上场景的关键点		
1. 改需求		
2. bug的反复出现		

### 持续集成

对于第一点，无可争议，这个是无法预料和避免的。对于第二点，是否有解决方案？从实践的角度来看，还真有，那就是**<font color=red>[持续集成][chixujicheng]**</font>。

具体在这里就不具体展开了。回到我们关心的问题上，解答如何解决bug的反复出现的问题。		

现在项目开发，大家都是分层开发。常见的分层方式是MVC。bug可能出现在MVC的任何1个地方。
回想我们解决bug的过程。我们首先预期我们写的代码功能是如何执行的，然后在输入原始参数，查看结果是否正确。
每1个bug都是如此。既然我们是工程师，是否可以把这个过程自动化？
自动化的过程也就是自动化测试。通过写测试代码，自动化执行测试代码，我们可以测试我们已经写的功能是否出现问题。针对修改公共代码引发的异常，我们可以通过自动化测试出以前功能是否出现异常。
整个过程，可以在持续集成这个方案中实现。


### 结尾
本篇内容结构组织的不是很好，尝试换一种写作手法。考虑写一篇个人对持续集成的理解，发现不如大家总结的好，索性放上百度百科的链接。

针对《重构》这本书，其实我看的很快，看了开头的测试重要性以后，后面的内容草草翻完，主要原因是后面是针对代码层面的具体优化方法和设计模式在ruby中的实现。另外1个原因是这本书翻译的很烂，很多内容我看了半天理解以后发现原来是翻译的问题。原因和解决方案其实有1个通俗的叫法。



[chixujicheng]:http://baike.baidu.com/view/5253255.htm
